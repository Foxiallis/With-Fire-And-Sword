namespace = WFAS_crimea
#Crimean raiding parties
country_event = {
	id = WFAS_crimea.1
	title = "WFAS_crimea_raid_start_title"
	desc = "WFAS_crimea_raid_start_desc"
	picture = HORDE_ON_HORSEBACK_eventPicture
	fire_only_once = yes
	trigger = {
		tag = CRI
		OR = {
			has_reform = steppe_horde
			has_reform = steppe_horde_legacy
		}
	}
	mean_time_to_happen = {
		months = 12
	}
	immediate = {
		set_country_flag = WFAS_crimea_raided_flag
	}
	option = {
		name = "WFAS_crimea_raid_start_forbid"
		if = {
			limit = {
				has_estate = estate_nomadic_tribes
			}
			add_estate_loyalty = {
				estate = estate_nomadic_tribes
				loyalty = -10
			}
		}
		add_country_modifier = {
			name = WFAS_forbidden_raiding
			duration = -1
		}
		custom_tooltip = WFAS_unlock_raiding_decisions
		ai_chance = {
			factor = 0
		}
	}
	option = {
		name = "WFAS_crimea_raid_start_restrict"
		if = {
			limit = {
				has_estate = estate_nomadic_tribes
			}
			add_estate_loyalty = {
				estate = estate_nomadic_tribes
				loyalty = 10
			}
		}
		add_country_modifier = {
			name = WFAS_restricted_raiding
			duration = -1
		}
		custom_tooltip = WFAS_unlock_raiding_decisions
		ai_chance = {
			factor = 1
		}
	}
}

#Hidden event to kickstart raid
country_event = {
	id = WFAS_crimea.2
	hidden = yes
	trigger = {
		OR = {
			AND = {
				has_country_modifier = WFAS_restricted_raiding
				had_country_flag = {
					flag = WFAS_crimea_raided_flag
					days = 1825
				}
			}
			AND = {
				has_country_modifier = WFAS_unrestricted_raiding
				had_country_flag = {
					flag = WFAS_crimea_raided_flag
					days = 730
				}
			}
		}
		is_at_war = no
	}
	mean_time_to_happen = {
		months = 2
	}
	immediate = {
		random_province = {
			limit = {
				any_neighbor_province = {
					owned_by = ROOT
				}
				owner = {
					NOT = {
						OR = {
							has_guaranteed = ROOT
							overlord_of = ROOT
							alliance_with = ROOT
							tag = ROOT
						}
					}
				}
				NOT = {
					culture = ROOT
				}
			}
			save_global_event_target_as = WFAS_crimean_raid_province
		}
		clr_country_flag = WFAS_crimea_raided_flag
	}
	option = {
		if = {
			limit = {
				event_target:WFAS_crimean_raid_province = {
					owner = {
						has_estate_privilege = WFAS_protect_from_raidings
					}
				}
			}
			random_list = {
				8 = {
					country_event = {
						id = WFAS_crimea.4
						days = 1
					}
					event_target:WFAS_crimean_raid_province = {
						owner = {
							country_event = {
								id = WFAS_crimea.6
								days = 1
							}
						}
					}
				}
				2 = {
					country_event = {
						id = WFAS_crimea.3
						days = 1
					}
					event_target:WFAS_crimean_raid_province = {
						owner = {
							country_event = {
								id = WFAS_crimea.5
								days = 1
							}
						}
					}
				}
			}
		}
		else = {
			random_list = {
				2 = {
					country_event = {
						id = WFAS_crimea.4
						days = 1
					}
					event_target:WFAS_crimean_raid_province = {
						owner = {
							country_event = {
								id = WFAS_crimea.6
								days = 1
							}
						}
					}
				}
				8 = {
					country_event = {
						id = WFAS_crimea.3
						days = 1
					}
					event_target:WFAS_crimean_raid_province = {
						owner = {
							country_event = {
								id = WFAS_crimea.5
								days = 1
							}
						}
					}
				}
			}
		}
		set_country_flag = WFAS_crimea_raided_flag
	}
}

#Raid successful
country_event = {
	id = WFAS_crimea.3
	title = "WFAS_crimea_raid_successful_title"
	desc = {
		trigger = {
			event_target:WFAS_crimean_raid_province = {
				owner = {
					has_estate_privilege = WFAS_protect_from_raidings
				}
			}
		}
		desc = "WFAS_crimea_raid_successful_cossack_desc"
	}
	desc = {
		trigger = {
			NOT = {
				event_target:WFAS_crimean_raid_province = {
					owner = {
						has_estate_privilege = WFAS_protect_from_raidings
					}
				}
			}
		}
		desc = "WFAS_crimea_raid_successful_desc"
	}
	picture = VILLAGE_RAIDED_eventPicture
	is_triggered_only = yes
	option = {
		name = "WFAS_crimea_raid_successful_option"
		add_treasury = 50
		add_horde_unity = 15
		random_list = {
			1 = {
				add_adm_power = 50
			}
			1 = {
				add_dip_power = 50
			}
			1 = {
				add_mil_power = 50
			}
		}
		event_target:WFAS_crimean_raid_province = {
			owner = {
				add_opinion = {
					who = ROOT
					modifier = slaves_raided
				}
			}
		}
		tooltip = {
			event_target:WFAS_crimean_raid_province = {
				add_devastation = 20
				random_list = {
					1 = {
						add_base_tax = -1
					}
					1 = {
						add_base_production = -1
					}
					1 = {
						add_base_manpower = -1
					}
				}
			}
		}
	}
}

#Raid failed
country_event = {
	id = WFAS_crimea.4
	title = "WFAS_crimea_raid_failed_title"
	desc = {
		trigger = {
			event_target:WFAS_crimean_raid_province = {
				owner = {
					has_estate_privilege = WFAS_protect_from_raidings
				}
			}
		}
		desc = "WFAS_crimea_raid_failed_cossack_desc"
	}
	desc = {
		trigger = {
			NOT = {
				event_target:WFAS_crimean_raid_province = {
					owner = {
						has_estate_privilege = WFAS_protect_from_raidings
					}
				}
			}
		}
		desc = "WFAS_crimea_raid_failed_desc"
	}
	picture = TRANSYLVANIA_BETHLEN_INVASION_eventPicture
	is_triggered_only = yes
	option = {
		name = "WFAS_crimea_raid_failed_option"
		add_prestige = -5
		add_horde_unity = -10
	}
}

#Raid successful (target)
country_event = {
	id = WFAS_crimea.5
	title = "WFAS_crimea_raid_successful_target_title"
	desc = {
		trigger = {
			has_estate_privilege = WFAS_protect_from_raidings
		}
		desc = "WFAS_crimea_raid_successful_target_cossack_desc"
	}
	desc = {
		trigger = {
			NOT = {
				has_estate_privilege = WFAS_protect_from_raidings
			}
		}
		desc = "WFAS_crimea_raid_successful_target_desc"
	}
	picture = VILLAGE_RAIDED_eventPicture
	is_triggered_only = yes
	option = {
		name = "WFAS_crimea_raid_successful_target_option"
		trigger = {
			NOT = {
				has_estate_privilege = WFAS_protect_from_raidings
			}
		}
		event_target:WFAS_crimean_raid_province = {
			add_devastation = 20
			random_list = {
				1 = {
					add_base_tax = -1
				}
				1 = {
					add_base_production = -1
				}
				1 = {
					add_base_manpower = -1
				}
			}
		}
	}
	option = {
		name = "WFAS_crimea_raid_successful_target_cossack_option"
		trigger = {
			has_estate_privilege = WFAS_protect_from_raidings
		}
		add_estate_loyalty_modifier = {
			estate = estate_cossacks
			desc = WFAS_reprimanded_desc
			loyalty = -5
			duration = 730
		}
		event_target:WFAS_crimean_raid_province = {
			add_devastation = 20
			random_list = {
				1 = {
					add_base_tax = -1
				}
				1 = {
					add_base_production = -1
				}
				1 = {
					add_base_manpower = -1
				}
			}
		}
	}
}

#Raid failed (target)
country_event = {
	id = WFAS_crimea.6
	title = "WFAS_crimea_raid_failed_target_title"
	desc = {
		trigger = {
			has_estate_privilege = WFAS_protect_from_raidings
		}
		desc = "WFAS_crimea_raid_failed_target_cossack_desc"
	}
	desc = {
		trigger = {
			NOT = {
				has_estate_privilege = WFAS_protect_from_raidings
			}
		}
		desc = "WFAS_crimea_raid_failed_target_desc"
	}
	picture = TRANSYLVANIA_BETHLEN_INVASION_eventPicture
	is_triggered_only = yes
	option = {
		name = "WFAS_crimea_raid_failed_target_option"
		add_prestige = 5
		if = {
			limit = {
				has_estate_privilege = WFAS_protect_from_raidings
			}
			add_estate_loyalty_modifier = {
				estate = estate_cossacks
				desc = WFAS_defended_raid_desc
				loyalty = 5
				duration = 730
			}
		}
	}
}

#Fall of the Western Tatars
country_event = {
	id = WFAS_crimea.7
	title = "WFAS_crimea_no_tatars_title"
	desc = "WFAS_crimea_no_tatars_desc"
	picture = REFUGEES_ESCAPING_eventPicture
	fire_only_once = yes
	trigger = {
		tag = CRI
		NOT = {
			OR = {
				exists = GOL
				exists = GLH
				exists = AST
			}
		}
	}
	mean_time_to_happen = {
		months = 12
	}
	option = {
		name = "WFAS_crimea_no_tatars_accept"
		add_stability = -1
		add_country_modifier = {
			name = WFAS_crimea_astrakhan_refugees
			duration = -1
		}
		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = "WFAS_crimea_no_tatars_turn"
		add_prestige = -5
		ai_chance = {
			factor = 0
		}
	}
}

#Slave trade prospects
#Burning of Moscow
#Circassian favors
#Treaty of Karlowitz
#Land of Silk and Honey
#Introduction of Tobacco to Europe